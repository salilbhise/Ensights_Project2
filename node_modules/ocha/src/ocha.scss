@import 'util/slice';
@import 'util/equal';
@import 'util/comparison';
@import 'functions/language';
@import 'functions/not';
@import 'functions/comparison';
@import 'functions/type';
@import 'functions/inspection';
@import 'functions/keys';

$standalone: (
  'ok',
  'true',
  'false',
  'null',
  'empty',
);

@mixin expect($args) {
  $value: nth($args, 1);
  $functions: -ocha-slice($args, 2, length($args) - 1);
  $final: nth($args, length($args));

  @if index($standalone, $final) {
    $functions: append($functions, $final);
    $final: null;
  }

  $assertion: (
    value: $value,
    negative: false,
    length: false,
    all: true,
    only: true,
  );

  @each $func in $functions {
    @if index($functions, $func) == length($functions) {
      $assertion: call('-ocha-#{$func}', $assertion, $final);
    }
    @else {
      $assertion: call('-ocha-#{$func}', $assertion);
    }
  }
}
